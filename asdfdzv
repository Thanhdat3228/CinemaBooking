[1mdiff --git a/Controllers/BookingController.cs b/Controllers/BookingController.cs[m
[1mindex 1771753..1a84748 100644[m
[1m--- a/Controllers/BookingController.cs[m
[1m+++ b/Controllers/BookingController.cs[m
[36m@@ -1,6 +1,202 @@[m
[31m-Ôªønamespace CinemaBooking.Controllers[m
[32m+[m[32mÔªøusing CinemaBooking.Data;[m
[32m+[m[32musing CinemaBooking.Models;[m
[32m+[m[32musing Microsoft.AspNetCore.Mvc;[m
[32m+[m[32musing Microsoft.EntityFrameworkCore;[m
[32m+[m
[32m+[m[32mnamespace CinemaBooking.Controllers[m
 {[m
[31m-    public class BookingController[m
[32m+[m[32m    public class BookingController : Controller[m
     {[m
[32m+[m[32m        private readonly ApplicationDbContext _context;[m
[32m+[m
[32m+[m[32m        // Constructor: Nh·∫≠n DbContext t·ª´ Dependency Injection[m
[32m+[m[32m        // DbContext d√πng ƒë·ªÉ truy v·∫•n v√† l∆∞u d·ªØ li·ªáu v√†o database[m
[32m+[m[32m        public BookingController(ApplicationDbContext context)[m
[32m+[m[32m        {[m
[32m+[m[32m            _context = context;[m
[32m+[m[32m        }[m
[32m+[m
[32m+[m[32m        // ========== PH∆Ø∆†NG TH·ª®C 1: HI·ªÇN TH·ªä S∆† ƒê·ªí GH·∫æ ==========[m
[32m+[m[32m        /// <summary>[m
[32m+[m[32m        /// Hi·ªÉn th·ªã s∆° ƒë·ªì gh·∫ø c·ªßa m·ªôt su·∫•t chi·∫øu[m
[32m+[m[32m        ///[m[41m [m
[32m+[m[32m        /// Tham s·ªë:[m
[32m+[m[32m        ///   - showTimeId: ID c·ªßa su·∫•t chi·∫øu[m
[32m+[m[32m        ///[m[41m [m
[32m+[m[32m        /// Lu·ªìng:[m
[32m+[m[32m        /// 1. T√¨m ShowTime theo ID (k√®m theo Movie, Cinema, Seats)[m
[32m+[m[32m        /// 2. L·∫•y danh s√°ch ID c√°c gh·∫ø ƒë√£ b·ªã ƒë·∫∑t (c√≥ trong Bookings)[m
[32m+[m[32m        /// 3. G·ª≠i d·ªØ li·ªáu t·ªõi View ƒë·ªÉ hi·ªÉn th·ªã s∆° ƒë·ªì gh·∫ø:[m
[32m+[m[32m        ///    - Gh·∫ø tr·ªëng: m√†u xanh (c√≥ th·ªÉ ch·ªçn)[m
[32m+[m[32m        ///    - Gh·∫ø ƒë√£ ƒë·∫∑t: m√†u ƒë·ªè (b·ªã disable)[m
[32m+[m[32m        /// </summary>[m
[32m+[m[32m        public IActionResult SelectSeats(int showTimeId)[m
[32m+[m[32m        {[m
[32m+[m[32m            // B∆∞·ªõc 1: L·∫•y th√¥ng tin ShowTime t·ª´ database[m
[32m+[m[32m            // Include() d√πng ƒë·ªÉ l·∫•y k√®m Movie, Cinema, v√† Seats li√™n quan[m
[32m+[m[32m            var showTime = _context.ShowTimes[m
[32m+[m[32m                .Include(s => s.Movie)      // L·∫•y t√™n phim[m
[32m+[m[32m                .Include(s => s.Cinema)     // L·∫•y t√™n r·∫°p[m
[32m+[m[32m                .Include(s => s.Seats)      // L·∫•y danh s√°ch gh·∫ø[m
[32m+[m[32m                .FirstOrDefault(s => s.Id == showTimeId);[m
[32m+[m
[32m+[m[32m            // Ki·ªÉm tra n·∫øu ShowTime kh√¥ng t·ªìn t·∫°i[m
[32m+[m[32m            if (showTime == null)[m
[32m+[m[32m                return NotFound("Kh√¥ng t√¨m th·∫•y su·∫•t chi·∫øu");[m
[32m+[m
[32m+[m[32m            // B∆∞·ªõc 2: L·∫•y danh s√°ch ID c√°c gh·∫ø ƒë√£ ƒë∆∞·ª£c ƒë·∫∑t[m
[32m+[m[32m            // T√¨m t·∫•t c·∫£ Booking c·ªßa ShowTime n√†y, r·ªìi l·∫•y SeatId[m
[32m+[m[32m            var bookedSeatIds = _context.Bookings[m
[32m+[m[32m                .Where(b => b.ShowTimeId == showTimeId)  // Ch·ªâ l·∫•y booking c·ªßa su·∫•t chi·∫øu n√†y[m
[32m+[m[32m                .Select(b => b.SeatId)                   // L·∫•y ID gh·∫ø[m
[32m+[m[32m                .ToList();[m
[32m+[m
[32m+[m[32m            // B∆∞·ªõc 3: G·ª≠i d·ªØ li·ªáu t·ªõi View th√¥ng qua ViewBag[m
[32m+[m[32m            // ViewBag l√† Dictionary ƒë·ªÉ truy·ªÅn d·ªØ li·ªáu t·ª´ Controller t·ªõi View[m
[32m+[m[32m            ViewBag.ShowTime = showTime;[m
[32m+[m[32m            ViewBag.Seats = showTime.Seats.ToList();[m
[32m+[m[32m            ViewBag.BookedSeatIds = bookedSeatIds;[m
[32m+[m
[32m+[m[32m            return View();[m
[32m+[m[32m        }[m
[32m+[m
[32m+[m[32m        // ========== PH∆Ø∆†NG TH·ª®C 2: T·∫†O BOOKING (ƒê·∫∂T V√â) ==========[m
[32m+[m[32m        /// <summary>[m
[32m+[m[32m        /// X·ª≠ l√Ω khi ng∆∞·ªùi d√πng ch·ªçn gh·∫ø v√† b·∫•m "X√°c nh·∫≠n"[m
[32m+[m[32m        ///[m[41m [m
[32m+[m[32m        /// Tham s·ªë:[m
[32m+[m[32m        ///   - showTimeId: ID su·∫•t chi·∫øu[m
[32m+[m[32m        ///   - seatIds: Array ID c√°c gh·∫ø ƒë∆∞·ª£c ch·ªçn[m
[32m+[m[32m        ///[m[41m [m
[32m+[m[32m        /// Lu·ªìng:[m
[32m+[m[32m        /// 1. Ki·ªÉm tra ng∆∞·ªùi d√πng ch·ªçn √≠t nh·∫•t 1 gh·∫ø[m
[32m+[m[32m        /// 2. Ki·ªÉm tra c√°c gh·∫ø ch·ªçn c√≥ tr·ªëng kh√¥ng[m
[32m+[m[32m        /// 3. N·∫øu tr·ªëng ‚Üí T·∫°o Booking cho t·ª´ng gh·∫ø[m
[32m+[m[32m        /// 4. L∆∞u v√†o database[m
[32m+[m[32m        /// 5. Redirect t·ªõi trang xem v√©[m
[32m+[m[32m        /// </summary>[m
[32m+[m[32m        [HttpPost]  // Ph∆∞∆°ng th·ª©c n√†y nh·∫≠n d·ªØ li·ªáu t·ª´ form POST[m
[32m+[m[32m        public IActionResult Confirm(int showTimeId, int[] seatIds)[m
[32m+[m[32m        {[m
[32m+[m[32m            // B∆∞·ªõc 1: Ki·ªÉm tra ng∆∞·ªùi d√πng c√≥ ch·ªçn gh·∫ø kh√¥ng[m
[32m+[m[32m            if (seatIds == null || seatIds.Length == 0)[m
[32m+[m[32m            {[m
[32m+[m[32m                // N·∫øu kh√¥ng ch·ªçn ‚Üí l∆∞u th√¥ng b√°o l·ªói v√†o TempData[m
[32m+[m[32m                // TempData d√πng ƒë·ªÉ l∆∞u data t·∫°m th·ªùi cho l·∫ßn request ti·∫øp theo[m
[32m+[m[32m                TempData["Error"] = "Ch·ªçn √≠t nh·∫•t 1 gh·∫ø";[m
[32m+[m[32m                return RedirectToAction("SelectSeats", new { showTimeId });[m
[32m+[m[32m            }[m
[32m+[m
[32m+[m[32m            // B∆∞·ªõc 2: Ki·ªÉm tra c√°c gh·∫ø ch·ªçn c√≥ b·ªã ƒë·∫∑t r·ªìi kh√¥ng[m
[32m+[m[32m            // N·∫øu c√≥ gh·∫ø n√†o ƒë√£ c√≥ booking ‚Üí b√°o l·ªói[m
[32m+[m[32m            // FirstOrDefault() tr·∫£ v·ªÅ ph·∫ßn t·ª≠ ƒë·∫ßu ti√™n n·∫øu c√≥, NULL n·∫øu kh√¥ng c√≥[m
[32m+[m[32m            var booked = _context.Bookings[m
[32m+[m[32m                .Where(b => b.ShowTimeId == showTimeId && seatIds.Contains(b.SeatId))[m
[32m+[m[32m                .FirstOrDefault();[m
[32m+[m
[32m+[m[32m            if (booked != null)[m
[32m+[m[32m            {[m
[32m+[m[32m                TempData["Error"] = "Gh·∫ø n√†y ƒë√£ c√≥ ng∆∞·ªùi ƒë·∫∑t";[m
[32m+[m[32m                return RedirectToAction("SelectSeats", new { showTimeId });[m
[32m+[m[32m            }[m
[32m+[m
[32m+[m[32m            // B∆∞·ªõc 3: T·∫°o Booking cho t·ª´ng gh·∫ø ƒë∆∞·ª£c ch·ªçn[m
[32m+[m[32m            var userId = 1; // T·∫°m th·ªùi (sau s·∫Ω l·∫•y t·ª´ Identity/Login)[m
[32m+[m[41m            [m
[32m+[m[32m            foreach (var seatId in seatIds)[m
[32m+[m[32m            {[m
[32m+[m[32m                // T·∫°o object Booking m·ªõi[m
[32m+[m[32m                var booking = new Booking[m
[32m+[m[32m                {[m
[32m+[m[32m                    UserId = userId,           // ID ng∆∞·ªùi d√πng ƒë·∫∑t v√©[m
[32m+[m[32m                    ShowTimeId = showTimeId,   // ID su·∫•t chi·∫øu[m
[32m+[m[32m                    SeatId = seatId,           // ID gh·∫ø ƒë∆∞·ª£c ch·ªçn[m
[32m+[m[32m                    BookingDate = DateTime.Now // Th·ªùi gian ƒë·∫∑t v√© (ng√†y gi·ªù hi·ªán t·∫°i)[m
[32m+[m[32m                };[m
[32m+[m[41m                [m
[32m+[m[32m                // Th√™m Booking v√†o DbContext (ch∆∞a l∆∞u v√†o DB l√∫c n√†y)[m
[32m+[m[32m                _context.Bookings.Add(booking);[m
[32m+[m[32m            }[m
[32m+[m
[32m+[m[32m            // B∆∞·ªõc 4: L∆∞u t·∫•t c·∫£ Bookings v√†o database[m
[32m+[m[32m            // SaveChanges() th·ª±c thi t·∫•t c·∫£ c√°c thay ƒë·ªïi (Add, Update, Delete)[m
[32m+[m[32m            _context.SaveChanges();[m
[32m+[m
[32m+[m[32m            // B∆∞·ªõc 5: Hi·ªÉn th·ªã th√¥ng b√°o th√†nh c√¥ng[m
[32m+[m[32m            TempData["Success"] = "ƒê·∫∑t v√© th√†nh c√¥ng!";[m
[32m+[m[41m            [m
[32m+[m[32m            // Chuy·ªÉn h∆∞·ªõng (Redirect) t·ªõ